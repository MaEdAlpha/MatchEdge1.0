<ng-container
*ngIf="isEdit; then editSavedBet else displayNewForm"></ng-container>

<ng-template #editSavedBet>
  <div mat-dialog-content>
    <hr>
    <div class="title-container">
      <div class="text-details">
        <h1 class="title-details">{{data.activeBet.selection}}</h1>
        <h2 class="title-details"> {{data.activeBet.fixture}}</h2>
        <h3 class="title-details">{{data.activeBet.matchDetail | date: 'EEE dd LLL HH:mm'}}</h3>
      </div>

      <div class="logo-container">
        <img class="logo" src="/assets/img/fcLogo/{{data.activeBet.logo}}.png" alt="">
      </div>
    </div>
    <hr>
    <form [formGroup]="sabFormValues" (ngSubmit)="onSubmit()">
      <div class="edit-main-fields">
        <div class="sab-matched-container">
          <mat-form-field>
            <mat-slide-toggle class="example-margin" formControlName="BetState" [color]="color" [checked]="checked" [disabled]="disabled">
              <div class="sab-matched" *ngIf="sabFormValues.value.BetState; else unMatched"> Matched </div>
              <ng-template class="sab-unmatched" #unMatched>Unmatched!</ng-template>
            </mat-slide-toggle>
            <input formControlName = "BetState" matInput #value hidden />
          </mat-form-field>
        </div>

          <div class="bookie-row">
            <div class="bookie-column1 column-base ">
              <p> Back Bet</p>
            </div>
            <div class="bookie-column2 column-base ">
              <button mat-button class="bookie-link bookie-container" href= ''></button>
            </div>
            <div class="bookie-column3 column-base ">

              <mat-form-field class="sab-values" appearance="fill">
                <mat-hint align="end">Back Stake</mat-hint>
                <mat-label>Prev. {{data.activeBet.stake | currency:'GBP'}}</mat-label>
                <input formControlName="Stake" type="number" required  matInput placeholder="{{getRealtimeUpdate().value.stake | slice : '2' | currency : 'GBP':'1.0-0' }}">
                <span matPrefix>£&nbsp;</span>
                <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
              </mat-form-field>

              <mat-form-field class="sab-values" appearance="fill">
                <mat-label>Prev. {{data.activeBet.backOdd}}</mat-label>
                <input formControlName="BackOdds"
                required
                type="number"
                step="0.1"
                matInput
                placeholder="{{getRealtimeUpdate().get('BackOdds').value}}">
                <mat-hint align="end">Back Odds</mat-hint>
                <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
              </mat-form-field>
            </div>
          </div>

          <div class="exchange-row">

            <div class="exchange-column1 column-base">
              <p> Lay Bet</p>
            </div>
            <div class="exchange-column2 column-base ">
              <button mat-button class="exchange-link bookie-container" href= ''></button>
            </div>
            <div class="exchange-column3 column-base ">
            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint align="end">Lay Odds</mat-hint>
              <mat-label>Prev. {{data.activeBet.layOdd}}</mat-label>
              <input formControlName="LayOdds" required type="number" step="0.1" matInput placeholder="{{getRealtimeUpdate().get('LayOdds').value}}">
              <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
            </mat-form-field>

            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint align="end">Lay Stake</mat-hint>
              <mat-label class="auto-calc-label"> Prev. {{data.activeBet.layStake | currency:'GBP'}}</mat-label>
              <input class="auto-calc-input" formControlName="LayStake" required readonly matInput placeholder="{{getLayStake( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value) }}" >
              <span matPrefix>£&nbsp;</span>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="auto-calculated-fields">

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="QL" matInput readonly placeholder="{{getQL( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value) }}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">QL</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="Liability" matInput readonly placeholder="{{getLiability( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <mat-hint align="end">Liability</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="FTA" matInput readonly placeholder="{{getFTA( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">FTA</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="ROI" matInput readonly placeholder="{{ getROI( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matSuffix>%&nbsp;</span>
          <mat-hint align="end">ROI</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="Sauce" matInput readonly placeholder="{{getSauce( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">SS</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="MRValue" matInput readonly placeholder="{{getMatchRating( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">MR</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="EstValue" matInput readonly placeholder="{{getEstValue( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">EV</mat-hint>
        </mat-form-field>

      </div>

        <div class="over-ride-pl">
          <div class="pl-input">
            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint>Final P/L</mat-hint>
              <mat-label class="auto-calc-label">Current. {{data.activeBet.pl | currency:'GBP'}}</mat-label>
              <input class="auto-calc-input" formControlName="PL" required matInput placeholder="{{getRealtimeUpdate().get('PL').value}}">
              <mat-error *ngIf="sabFormValues.controls.PL.errors">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
          <div class="comments-cont">
            <mat-form-field class="user-comments" appearance="outline">
              <mat-label class="auto-calc-label">Match Comments</mat-label>
              <textarea class="auto-calc-input" formControlName="MatchInfo" required matInput placeholder=" "></textarea>
              <mat-hint> Allowed char. ({{sabFormValues.value.MatchInfo == null ? sabFormValues.value.MatchInfo == ' ' : sabFormValues.value.MatchInfo.length}}/140)</mat-hint>
              <mat-error *ngIf="sabFormValues.controls.MatchInfo.errors">{{getErrorMessage()}} </mat-error>
            </mat-form-field>
          </div>
          <!-- <button mat-button class="popup-btn" (click)="isEarlyCashout=!isEarlyCashout" >Override</button> -->
        </div>

    </form>
        <!-- How to handle this, all in on form? -->
  </div>

  <div mat-dialog-actions>
    <button mat-button class="popup-btn" (click)="onNoClick()"> Cancel </button>
    <button mat-button class="popup-btn" type="submit" (click)="updateForm()" [disabled]="isDisabled" [ngClass]="{'glow' : sabFormValues.touched && sabFormValues.status == 'VALID'}">Update</button>
    <div class="user-update-notification">
      <h4 class="update-message cdk-global-overlay-wrapper"> {{sabFormValues.dirty && sabFormValues.status == "VALID" ? 'Update Changes?' : ''}}</h4>
    </div>
  </div>
</ng-template>

 <ng-template #displayNewForm>

   <div mat-dialog-content>
    <hr>
    <div class="title-container">
      <div class="text-details">
        <h1 class="title-details">{{data.activeBet.selection}}</h1>
        <h2 class="title-details"> {{data.activeBet.fixture}}</h2>
        <h3 class="title-details">{{data.activeBet.matchDetail | date: 'EEE dd LLL HH:mm'}}</h3>
      </div>

      <div class="logo-container">
        <img class="logo" src="/assets/img/fcLogo/{{data.activeBet.logo}}.png" alt="">
      </div>
    </div>
    <hr>
     <p>Enter New Match Details for {{data.activeBet.selection}}</p>
     <form [formGroup]="sabFormValues">
      <div class="edit-main-fields">
        <div class="bookie-row">
            <div class="bookie-column1 column-base ">
              <p> Back Bet</p>
            </div>
            <div class="bookie-column2 column-base ">
              <button mat-button class="bookie-link bookie-container" href= ''></button>
            </div>
            <div class="bookie-column3 column-base ">

              <mat-form-field class="sab-values" appearance="fill">
                <mat-hint align="end">Back Stake</mat-hint>
                <mat-label>Stake</mat-label>
                <input formControlName="Stake" required matInput placeholder="{{getRealtimeUpdate().value.stake | slice : '2' | currency : 'GBP':'1.0-0' }}">
                <span matPrefix>£&nbsp;</span>
                <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
              </mat-form-field>
              <mat-form-field class="sab-values" appearance="fill">
                <mat-hint align="end">Back Odds</mat-hint>
                <mat-label>Back Odds</mat-label>
                <input formControlName="BackOdds" required matInput placeholder="{{getRealtimeUpdate().get('BackOdds').value}}">
                <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
              </mat-form-field>
            </div>
          </div>

          <div class="exchange-row">

            <div class="exchange-column1 column-base">
              <p> Lay Bet</p>
            </div>
            <div class="exchange-column2 column-base ">
              <button mat-button class="exchange-link bookie-container" href= ''></button>
            </div>
            <div class="exchange-column3 column-base ">
            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint align="end">Lay Odds</mat-hint>
              <mat-label>Lay Odds {{data.activeBet.layOdd}}</mat-label>
              <input formControlName="LayOdds" required [readOnly]="true" matInput placeholder="{{getRealtimeUpdate().get('LayOdds').value}}">
              <mat-error *ngIf="sabFormValues.controls.BackOdds.errors">{{getErrorMessage()}}</mat-error>
            </mat-form-field>

            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint align="end">Lay Stake</mat-hint>
              <mat-label class="auto-calc-label">Lay Stake</mat-label>
              <input class="auto-calc-input" formControlName="LayStake" required readonly matInput placeholder="{{getLayStake( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value) }}" >
              <span matPrefix>£&nbsp;</span>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="auto-calculated-fields">

        <mat-form-field class="sab-values" appearance="outline">
          <input class="auto-calc-input" formControlName="QL" matInput readonly placeholder="{{getQL( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value) }}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">QL</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values" appearance="outline">
          <input class="auto-calc-input" formControlName="Liability" matInput readonly placeholder="{{getLiability( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <mat-hint align="end">Liability</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values" appearance="outline">
          <input class="auto-calc-input" formControlName="FTA" matInput readonly placeholder="{{getFTA( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">FTA</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values" appearance="outline">
          <input class="auto-calc-input" formControlName="ROI" matInput readonly placeholder="{{ getROI( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matSuffix>%&nbsp;</span>
          <mat-hint align="end">ROI</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="Sauce" matInput readonly placeholder="{{getSauce( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">SS</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values sab-values-auto-calc" appearance="outline">
          <input class="auto-calc-input" formControlName="MRValue" matInput readonly placeholder="{{getMatchRating( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">MR</mat-hint>
        </mat-form-field>

        <mat-form-field class="sab-values" appearance="outline">
          <input class="auto-calc-input" formControlName="EstValue" matInput readonly placeholder="{{getEstValue( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value )}}">
          <span matPrefix>£&nbsp;</span>
          <mat-hint align="end">EV</mat-hint>
        </mat-form-field>
      </div>

        <div class="over-ride-pl">
          <div class="pl-input">
            <mat-form-field class="sab-values" appearance="outline">
              <mat-hint>Final P/L</mat-hint>
              <mat-label class="auto-calc-label">P/L</mat-label>
              <input class="auto-calc-input" formControlName="PL" matInput placeholder="{{getQL( getRealtimeUpdate().get('BackOdds').value, getRealtimeUpdate().get('LayOdds').value, getRealtimeUpdate().get('Stake').value) }}">
              <mat-error *ngIf="sabFormValues.controls.PL.errors">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
          <div class="comments-cont">
            <mat-form-field class="user-comments" appearance="outline">
              <mat-label class="auto-calc-label">Match Comments</mat-label>
              <textarea class="auto-calc-input" formControlName="MatchInfo" required matInput placeholder="Enter comments here..."></textarea>
              <mat-hint> Allowed char. ({{sabFormValues.value.MatchInfo == null ? sabFormValues.value.MatchInfo == ' ' : sabFormValues.value.MatchInfo.length}}/140)</mat-hint>
              <mat-error *ngIf="sabFormValues.controls.MatchInfo.errors">{{getErrorMessage()}} </mat-error>
            </mat-form-field>
          </div>
          <!-- <button mat-button class="popup-btn" (click)="isEarlyCashout=!isEarlyCashout" >Override</button> -->
        </div>
        <div class="sab-matched-container">
          <mat-form-field>
            <mat-slide-toggle class="example-margin" formControlName="BetState" [color]="color" [checked]="checked" [disabled]="disabled">
              <div class="sab-matched" *ngIf="sabFormValues.value.BetState; else unMatched"> Matched </div>
              <ng-template class="sab-unmatched" #unMatched>Unmatched!</ng-template>
            </mat-slide-toggle>
            <input formControlName = "BetState" matInput #value hidden />
          </mat-form-field>
        </div>
        </form>
      </div>

      <div mat-dialog-actions>
        <button mat-button class="popup-btn" (click)="onNoClick()"> Cancel </button>
        <button mat-button class="popup-btn" (click)="updateForm()" [disabled]="isDisabled" [ngClass]="{'glow' : sabFormValues.touched && sabFormValues.status == 'VALID'}">Save</button>
        <div class="user-update-notification">
          <h4 class="update-message cdk-global-overlay-wrapper"> {{sabFormValues.dirty && sabFormValues.status == "VALID" ? 'Save Changes?' : ''}}</h4>
        </div>
      </div>
    </ng-template>

